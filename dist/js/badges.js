const badgeImgs=document.getElementsByClassName("badge-img");async function getUserId(){try{return(await(await fetch("/user-id")).json()).userId}catch(e){throw console.error(e),e}}async function retrieveBadges(){try{return(await(await fetch("/get-badges")).json()).badges}catch(e){console.error(e)}}function updateBadgeAppearance(e,a){for(var t of e){var r=t.getAttribute("data-badge-type"),s=t.getAttribute("data-badge-number");a[r][s]?t.classList.add("active"):t.classList.remove("active")}}async function updateBadgeStatus(e,a,t){try{var r=await retrieveBadges();t&&(r[e][a]=!0,await updateSessionAndDB(r))}catch(e){console.error(e)}}async function updateSessionAndDB(e){try{var a=await getUserId();a?(await fetch("/update-badges",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,updatedBadges:e})})).ok?console.log("Badges updated successfully!"):console.error("Error updating badges!"):console.error("Failed to retrieve user ID")}catch(e){console.error("There was a problem with the fetch operation:",e)}}async function initializeBadgeAppearance(){var e=await retrieveBadges();updateBadgeAppearance(badgeImgs,e)}initializeBadgeAppearance();export{updateBadgeStatus};